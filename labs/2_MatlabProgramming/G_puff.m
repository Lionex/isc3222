function [conc,M] = G_puff (m,Dx,Dy,v,b)
%G_PUFF: Gaussian puff for solving advection-dispersion equations 
% Synopsis: [c,M] = G_puff (m,Dx,Dy,v,b) 
% 
% Input: m  = mass [kg] 
%        Dx = dispersion coeffient in X direction [m^2/day] 
%        Dy = dispersion coeffient in Y direction [m^2/day] 
%        v  = flow velocity [m/day] 
%        b  = aquifier thickness [m] 
% 
% Output: conc = concentration of the containimant [kg/m^3] 
%         M    = movie of concentration contours 

if (nargin < 5),  b  = 1.0; end % m
if (nargin < 4),  v  = 0.5; end % m/day
if (nargin < 3),  Dx = 0.5; end % m^2/day
if (nargin < 2),  Dy = 0.1; end % m^2/day
if (nargin == 0), m  = 1.0; end % kg

% Start the loop of time. Vecterization is needed for the calculation.
% Do not use loop for the cells in the x-y space.
tmax = 100/v;
tmin = tmax/50;
dt   = tmax/50;

[X,Y,T]=meshgrid(0:2.5:100,-50:2.5:50,tmin:dt:tmax);

% Initalize the concentration matrix.
conc = zeros(size(X,1),size(Y,2),size(tmax:dt:tmin,3));

conc = (m./b) ./ (4.*pi.*sqrt(Dx.*Dy)) .* exp(-(X-v.*T    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0001    0.0001    0.0001    0.0001    0.0002    0.0002    0.0003
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0001    0.0001    0.0001    0.0002    0.0003    0.0004    0.0006    0.0007    0.0009    0.0012
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0001    0.0001    0.0002    0.0003    0.0004    0.0007    0.0010    0.0014    0.0019    0.0025    0.0031    0.0039
    0.0000    0.0000    0.0000    0.0001    0.0001    0.0002    0.0003    0.0005    0.0008    0.0013    0.0019    0.0027    0.0038    0.0052    0.0069    0.0088    0.0109
    0.0000    0.0000    0.0001    0.0001    0.0002    0.0004    0.0007    0.0012    0.0019    0.0030    0.0045    0.0066    0.0092    0.0126    0.0166    0.0212    0.0263
    0.0000    0.0001    0.0001    0.0003    0.0005    0.0009    0.0015    0.0025    0.0040    0.0062    0.0093    0.0135    0.0189    0.0258    0.0340    0.0435    0.0539
    0.0001    0.0001    0.0003    0.0005    0.0009    0.0016    0.0026    0.0044    0.0070    0.0108    0.0162    0.0235    0.0331    0.0450    0.0594    0.0760    0.0941
    0.0001    0.0002    0.0004    0.0007    0.0013    0.0023    0.0039    0.0065    0.0104    0.0161    0.0241    0.0350    0.0493    0.0671    0.0886    0.1132    0.1402
    0.0001    0.0003    0.0005    0.0009    0.0017    0.0029    0.0050    0.0083    0.0132    0.0204    0.0306    0.0445    0.0626    0.0852    0.1125    0.1438    0.1780
    0.0001    0.0003    0.0005    0.0010    0.0018    0.0032    0.0054    0.0089    0.0143    0.0221    0.0332    0.0482    0.0677    0.0923    0.1218    0.1557    0.1928
    0.0001    0.0003    0.0005    0.0009    0.0017    0.0029    0.0050    0.0083    0.0132    0.0204    0.0306    0.0445    0.0626    0.0852    0.1125    0.1438    0.1780
    0.0001    0.0002    0.0004    0.0007    0.0013    0.0023    0.0039    0.0065    0.0104    0.0161    0.0241    0.0350    0.0493    0.0671    0.0886    0.1132    0.1402
    0.0001    0.0001    0.0003    0.0005    0.0009    0.0016    0.0026    0.0044    0.0070    0.0108    0.0162    0.0235    0.0331    0.0450    0.0594    0.0760    0.0941
    0.0000    0.0001    0.0001    0.0003    0.0005    0.0009    0.0015    0.0025    0.0040    0.0062    0.0093    0.0135    0.0189    0.0258    0.0340    0.0435    0.0539
    0.0000    0.0000    0.0001    0.0001    0.0002    0.0004    0.0007    0.0012    0.0019    0.0030    0.0045    0.0066    0.0092    0.0126    0.0166    0.0212    0.0263
    0.0000    0.0000    0.0000    0.0001    0.0001    0.0002    0.0003    0.0005    0.0008    0.0013    0.0019    0.0027    0.0038    0.0052    0.0069    0.0088    0.0109
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0001    0.0001    0.0002    0.0003    0.0004    0.0007    0.0010    0.0014    0.0019    0.0025    0.0031    0.0039
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0001    0.0001    0.0001    0.0002    0.0003    0.0004    0.0006    0.0007    0.0009    0.0012
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0001    0.0001    0.0001    0.0001    0.0002    0.0002    0.0003
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0001    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000

  Columns 35 through 41

    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0001    0.0001    0.0001    0.0001    0.0001    0.0001    0.0001
    0.0004    0.0004    0.0005    0.0005    0.0005    0.0006    0.0006
    0.0014    0.0016    0.0018    0.0020    0.0021    0.0022    0.0021
    0.0047    0.0054    0.0061    0.0066    0.0070    0.0072    0.0071
    0.0131    0.0152    0.0171    0.0187    0.0197    0.0202    0.0200
    0.0315    0.0366    0.0412    0.0449    0.0474    0.0485    0.0480).^2./(4*Dx.*T) - Y.^2./(4*Dy.*T));

set(gca,'nextplot','replacechildren');
for it = 1:size(T,2);
    contourf(X(:,:,it),Y(:,:,it),conc(:,:,it));
    xlabel(gca,'X (m)');
    ylabel(gca,'Y (m)');
    time_title=['Simulation time t= ',num2str(it),' day'];
    title(gca,time_title)
    set(gca,'Visible','on');
    M(it)=getframe(gca); 
end

end
